{% extends "base_dashboard.html" %}

{% block title %}Dashboard - MisMatch{% endblock %}

{% block content %}
<div class="dashboard-container">

  <!-- Emoji Circle -->
  <div class="emoji-circle">
    <span class="emoji">
      {{ session.avatar if session.avatar else "ðŸ™‚" }}
    </span>
  </div>

  <!-- Clothing Boxes (nebeneinander) -->
  <div class="clothing-row">
    <!-- TOPS Box -->
    <div class="clothing-section">
      <h3 class="section-label">TOPS</h3>

      <div class="clothing-box-container">
        <button class="arrow-btn left" onclick="changeClothing('tops', -1)">â—€</button>

        <div class="clothing-box clickable"
             id="tops-box"
             onclick="togglePanel('tops')">
          <span class="placeholder">?</span>
        </div>

        <button class="arrow-btn right" onclick="changeClothing('tops', 1)">â–¶</button>
      </div>

      <!-- FILTER BUTTON -->
      <button class="filter-btn" onclick="togglePanel('tops')">Filter</button>

      <!-- FILTER PANEL -->
      <div class="clothing-panel" id="panel-tops">
        <select onchange="applyColorFilter('tops', this.value)">
          <option value="all">All colors</option>
        </select>

        <div class="clothing-grid" id="grid-tops"></div>
      </div>
    </div>

    <!-- BOTTOMS Box -->
    <div class="clothing-section">
      <h3 class="section-label">BOTTOMS</h3>

      <div class="clothing-box-container">
        <button class="arrow-btn left" onclick="changeClothing('bottoms', -1)">â—€</button>

        <div class="clothing-box clickable"
             id="bottoms-box"
             onclick="togglePanel('bottoms')">
          <span class="placeholder">?</span>
        </div>

        <button class="arrow-btn right" onclick="changeClothing('bottoms', 1)">â–¶</button>
      </div>

      <!-- FILTER BUTTON -->
      <button class="filter-btn" onclick="togglePanel('bottoms')">Filter</button>

      <!-- FILTER PANEL -->
      <div class="clothing-panel" id="panel-bottoms">
        <select onchange="applyColorFilter('bottoms', this.value)">
          <option value="all">All colors</option>
        </select>

        <div class="clothing-grid" id="grid-bottoms"></div>
      </div>
    </div>

    <!-- FOOTWEAR Box -->
    <div class="clothing-section">
      <h3 class="section-label">FOOTWEAR</h3>

      <div class="clothing-box-container">
        <button class="arrow-btn left" onclick="changeClothing('footwear', -1)">â—€</button>

        <div class="clothing-box clickable"
             id="footwear-box"
             onclick="togglePanel('footwear')">
          <span class="placeholder">?</span>
        </div>

        <button class="arrow-btn right" onclick="changeClothing('footwear', 1)">â–¶</button>
      </div>

      <!-- FILTER BUTTON -->
      <button class="filter-btn" onclick="togglePanel('footwear')">Filter</button>

      <!-- FILTER PANEL -->
      <div class="clothing-panel" id="panel-footwear">
        <select onchange="applyColorFilter('footwear', this.value)">
          <option value="all">All colors</option>
        </select>

        <div class="clothing-grid" id="grid-footwear"></div>
      </div>
    </div>
  </div>

  <!-- Buttons bottom (nebeneinander, mittig) -->
  <div class="action-buttons">
    <button class="mismatch-btn" onclick="generateMismatchOutfit()">MisMatch</button>
    <button class="save-btn" onclick="saveOutfit()">Save Outfit</button>
    <button class="upload-btn" onclick="openUploadModal()">ðŸ“· Upload</button>
  </div>
</div>

<!-- Upload Modal -->
<div id="upload-modal" class="modal" style="display: none;">
  <div class="modal-content">
    <span class="close-btn" onclick="closeUploadModal()">&times;</span>
    <h2>Upload Your Clothing</h2>
    <form id="upload-form" enctype="multipart/form-data">
      <div class="form-group">
        <label>Category:</label>
        <select id="upload-category" required>
          <option value="">Select category...</option>
          <option value="top">Top</option>
          <option value="bottom">Bottom</option>
          <option value="footwear">Footwear</option>
        </select>
      </div>
      <div class="form-group">
        <label>Image:</label>
        <input type="file" id="upload-image" accept="image/png, image/jpeg, image/jpg" required>
      </div>
      <button type="submit" class="save-btn">Upload</button>
    </form>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<!-- Clothing Data aus Python -->
<script>
  // Daten von Flask/Python in JavaScript verfÃ¼gbar machen
  const clothingData = {
    tops: {{ tops | tojson }},
    bottoms: {{ bottoms | tojson }},
    footwear: {{ footwear | tojson }}
  };
</script>

<!-- JavaScript File -->
<script src="{{ url_for('static', filename='js/generator.js') }}"></script>
{% endblock %}